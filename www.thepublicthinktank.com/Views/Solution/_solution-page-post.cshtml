    @model Solution_ReadVM
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Console.WriteLine();



}

<div class="d-flex justify-content-end gap-2 py-2">
<a href="#" class="btn btn-sm btn-outline-secondary">Share</a>
<a href="#" class="btn btn-sm btn-outline-secondary">Follow</a>
</div>
<div class="card mb-3 solution-card" id="solution-@Model.SolutionID">
    <div class="d-flex flex-row">

        <div class="dial-container">
        </div>
        <div class="flex-fill d-flex flex-column">

            <div class="card-header d-flex justify-content-between align-items-center" style="border-left:var(--bs-card-border-width) solid var(--bs-card-border-color); border-top-left-radius: 0;">
                <div>

                <h5 class="mb-0">@Model.Title</h5>
                <small class="text-muted">Posted by @Model.Author?.UserName on @Model.CreatedAt.ToString("MMM dd, yyyy")</small>
                </div>


                <div class="text-end d-flex align-items-center gap-1">

                   
                     @Html.Partial("~/Views/Shared/Components/_scope-ribbon.cshtml", Model.Scope)
                </div>
            </div>
            <div class="card-body d-flex flex-column justify-content-between">
                <p>@Model.Content</p>

                @if (Model.Categories != null && Model.Categories.Any())
                {
                    <div class="mt-2">
                        @foreach (var category in Model.Categories)
                        {
                            <span class="badge bg-secondary me-1">@category.CategoryName</span>
                        }
                    </div>
                }
            </div>
          
        </div>
       

    </div>
    

</div>

@* This script does load with cshtml because it is part of the initial page load *@
<script>
    console.log("DOMContentLoaded card for issue ID: @Model.SolutionID");
    document.addEventListener("DOMContentLoaded", () => {
        try {
            const SolutionID = '@Model.SolutionID';
            console.log("Fetching vote dial for issue:", SolutionID);

            fetch(`/solution/GetVoteDial?SolutionID=${SolutionID}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    console.log("Vote dial data received:", {SolutionID: SolutionID, dataLength: data.length});
                    const thisElement = document.querySelector(`#solution-${SolutionID}`);
                    if (!thisElement) {
                        console.error(`Element #solution-${SolutionID} not found`);
                        return;
                    }

                    const dialContainer = thisElement.querySelector('.dial-container');
                    if (dialContainer) {
                        dialContainer.innerHTML = data;
                        // Make sure this function exists and is defined before this script runs
                        if (typeof initializeVoteDial === 'function') {
                            try {
                                initializeVoteDial(SolutionID);
                            } catch (initError) {
                                console.error("Error in initializeVoteDial:", initError);
                            }
                        } else {
                            console.error("initializeVoteDial function is not defined");
                        }
                    } else {
                        console.error(`Dial container not found in #issue-${SolutionID}`);
                    }
                })
                .catch(error => console.error('Error fetching vote dial:', error));
        } catch (outerError) {
            console.error("Error in DOMContentLoaded handler:", outerError);
        }
    });
</script>